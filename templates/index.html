<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>Gyan Guru Website Monitor</title>-->
<!--    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">-->
<!--    <script>-->
<!--    function toggleDarkMode() {-->
<!--      document.body.classList.toggle('dark-mode');-->
<!--    }-->

<!--    function filterCategory(select) {-->
<!--      const selected = select.value.toLowerCase();-->
<!--      document.querySelectorAll("tbody tr").forEach(row => {-->
<!--        const cat = row.getAttribute("data-category");-->
<!--        row.style.display = (selected === "all" || cat === selected) ? "" : "none";-->
<!--      });-->
<!--    }-->

<!--    function showHistory(index) {-->
<!--      fetch(`/updates/${index}`)-->
<!--        .then(res => res.json())-->
<!--        .then(history => {-->
<!--          const modal = document.getElementById("historyModal");-->
<!--          const container = document.getElementById("historyContent");-->
<!--          container.innerHTML = "";-->
<!--          if (history.length === 0) {-->
<!--            container.innerHTML = "<p>No update history available.</p>";-->
<!--          } else {-->
<!--            history.forEach((item, i) => {-->
<!--              const div = document.createElement("div");-->
<!--              div.className = "history-entry";-->
<!--              div.innerHTML = `-->
<!--                <strong>Version ${i + 1}</strong> - <em>${item.timestamp}</em>-->
<!--                <pre>${item.content}</pre>-->
<!--                <hr>-->
<!--              `;-->
<!--              container.appendChild(div);-->
<!--            });-->
<!--          }-->
<!--          modal.style.display = "block";-->
<!--        });-->
<!--    }-->

<!--    function closeModal() {-->
<!--      document.getElementById("historyModal").style.display = "none";-->
<!--    }-->

<!--    function resetAll() {-->
<!--      if (confirm("Are you sure you want to reset all site tracking data?")) {-->
<!--        fetch("/reset_all", { method: "POST" })-->
<!--          .then(res => res.json())-->
<!--          .then(data => {-->
<!--            if (data.status === "reset") {-->
<!--              alert("All sites have been reset.");-->
<!--              location.reload();-->
<!--            } else {-->
<!--              alert("Reset failed.");-->
<!--            }-->
<!--          });-->
<!--      }-->
<!--    }-->

<!--    window.onclick = function(event) {-->
<!--      const modal = document.getElementById("historyModal");-->
<!--      if (event.target === modal) modal.style.display = "none";-->
<!--    };-->
<!--      setInterval(() => {-->
<!--  fetch("/table-data")-->
<!--    .then(res => res.text())-->
<!--    .then(html => {-->
<!--      document.querySelector("tbody").innerHTML = html;-->
<!--    });-->
<!--}, 60000); // Every 60 seconds-->

<!--    </script>-->
<!--</head>-->
<!--<body>-->

<!--&lt;!&ndash; ✅ HEADER WITH LOGO LEFT AND CENTERED TITLE &ndash;&gt;-->
<!--<div class="header-container">-->
<!--    <img src="{{ url_for('static', filename='gyan-guru.png') }}" alt="Gyan Guru Logo" class="logo">-->
<!--    <h1>🧠 Gyan Guru Website Monitor</h1>-->
<!--</div>-->

<!--&lt;!&ndash; ✅ TOP BAR: Add Site + Category + Dark Mode + Reset All &ndash;&gt;-->
<!--<div class="top-bar">-->
<!--    <form action="/add" method="POST" class="form-inline">-->
<!--        <input name="name" placeholder="Website Name" required>-->
<!--        <input name="url" placeholder="URL" required>-->
<!--        <input name="selector" placeholder="CSS Selector" required>-->
<!--        <input name="category" placeholder="Category" required>-->
<!--        <button type="submit">➕ Add Site</button>-->
<!--    </form>-->

<!--    <div class="top-controls">-->
<!--        <label>Category:</label>-->
<!--        <select onchange="filterCategory(this)">-->
<!--            <option value="all">All</option>-->
<!--            {% for cat in categories %}-->
<!--            <option value="{{ cat }}">{{ cat }}</option>-->
<!--            {% endfor %}-->
<!--        </select>-->

<!--        <button onclick="toggleDarkMode()">🌓 Dark Mode</button>-->
<!--        <button class="reset-button" onclick="resetAll()">🔁 Reset All</button>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; ✅ MONITORING TABLE &ndash;&gt;-->
<!--<table>-->
<!--    <thead>-->
<!--    <tr>-->
<!--        <th>Website</th>-->
<!--        <th>Category</th>-->
<!--        <th>URL</th>-->
<!--        <th>Updates</th>-->
<!--        <th>Status</th>-->
<!--        <th>Last Checked</th>-->
<!--        <th>Actions</th>-->
<!--    </tr>-->
<!--    </thead>-->
<!--    <tbody>-->
<!--    {% for site in urls %}-->
<!--    <tr data-category="{{ site.category.lower() }}">-->
<!--        <td>{{ site.name }}</td>-->
<!--        <td>{{ site.category }}</td>-->
<!--        <td><a href="{{ site.url }}" target="_blank">🔗 Visit</a></td>-->
<!--        <td>-->
<!--          <span class="badge {{ 'highlight' if site.update_count > 0 and not site.acknowledged else '' }}">-->
<!--            {{ site.update_count }}-->
<!--          </span>-->
<!--        </td>-->
<!--        <td>{{ "⏸️ Paused" if site.paused else "✅ Active" }}</td>-->
<!--        <td>{{ site.last_checked if site.last_checked else '—' }}</td>-->
<!--        <td>-->
<!--            <a href="/acknowledge/{{ loop.index0 }}">✅</a>-->
<!--            <a href="/pause/{{ loop.index0 }}">⏯️</a>-->
<!--            <a href="/reset/{{ loop.index0 }}">♻️</a>-->
<!--            <a href="/remove/{{ loop.index0 }}">🗑️</a>-->
<!--            <button onclick="showHistory({{ loop.index0 }})">📜 View History</button>-->
<!--        </td>-->
<!--    </tr>-->
<!--    {% endfor %}-->
<!--    </tbody>-->
<!--</table>-->

<!--&lt;!&ndash; ✅ UPDATE HISTORY MODAL &ndash;&gt;-->
<!--<div id="historyModal" class="modal">-->
<!--    <div class="modal-content">-->
<!--        <span class="close" onclick="closeModal()">×</span>-->
<!--        <h2>🔍 Update History</h2>-->
<!--        <div id="historyContent"></div>-->
<!--    </div>-->
<!--</div>-->

<!--</body>-->
<!--</html>-->

<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <title>Gyan Guru Website Monitor</title>-->
<!--  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">-->
<!--  <script>-->
<!--    // ✅ Toggle + persist dark mode-->
<!--    function toggleDarkMode() {-->
<!--      const isDark = document.body.classList.toggle('dark-mode');-->
<!--      localStorage.setItem('darkMode', isDark ? 'enabled' : 'disabled');-->
<!--    }-->

<!--    // ✅ Load dark mode from localStorage-->
<!--    window.onload = function() {-->
<!--      if (localStorage.getItem('darkMode') === 'enabled') {-->
<!--        document.body.classList.add('dark-mode');-->
<!--      }-->
<!--    };-->

<!--    function filterCategory(select) {-->
<!--      const selected = select.value.toLowerCase();-->
<!--      document.querySelectorAll("tbody tr").forEach(row => {-->
<!--        const cat = row.getAttribute("data-category");-->
<!--        row.style.display = (selected === "all" || cat === selected) ? "" : "none";-->
<!--      });-->
<!--    }-->

<!--    function showHistory(index) {-->
<!--      fetch(`/updates/${index}`)-->
<!--        .then(res => res.json())-->
<!--        .then(history => {-->
<!--          const modal = document.getElementById("historyModal");-->
<!--          const container = document.getElementById("historyContent");-->
<!--          container.innerHTML = "";-->
<!--          if (history.length === 0) {-->
<!--            container.innerHTML = "<p>No update history available.</p>";-->
<!--          } else {-->
<!--            history.forEach((item, i) => {-->
<!--              const div = document.createElement("div");-->
<!--              div.className = "history-entry";-->
<!--              div.innerHTML = `-->
<!--                <strong>Version ${i + 1}</strong> - <em>${item.timestamp}</em>-->
<!--                <pre>${item.content}</pre>-->
<!--                <hr>-->
<!--              `;-->
<!--              container.appendChild(div);-->
<!--            });-->
<!--          }-->
<!--          modal.style.display = "block";-->
<!--        });-->
<!--    }-->

<!--    function closeModal() {-->
<!--      document.getElementById("historyModal").style.display = "none";-->
<!--    }-->

<!--    function resetAll() {-->
<!--      if (confirm("Are you sure you want to reset all site tracking data?")) {-->
<!--        fetch("/reset_all", { method: "POST" })-->
<!--          .then(res => res.json())-->
<!--          .then(data => {-->
<!--            if (data.status === "reset") {-->
<!--              alert("All sites have been reset.");-->
<!--              location.reload();-->
<!--            } else {-->
<!--              alert("Reset failed.");-->
<!--            }-->
<!--          });-->
<!--      }-->
<!--    }-->

<!--    window.onclick = function(event) {-->
<!--      const modal = document.getElementById("historyModal");-->
<!--      if (event.target === modal) modal.style.display = "none";-->
<!--    };-->

<!--    // ✅ Auto-refresh table body every 60s-->
<!--    setInterval(() => {-->
<!--      fetch("/table-data")-->
<!--        .then(res => res.text())-->
<!--        .then(html => {-->
<!--          document.querySelector("tbody").innerHTML = html;-->
<!--        });-->
<!--    }, 60000);-->
<!--  </script>-->
<!--</head>-->
<!--<body>-->

<!--&lt;!&ndash; ✅ HEADER WITH LOGO LEFT AND CENTERED TITLE &ndash;&gt;-->
<!--<div class="header-container">-->
<!--  <img src="{{ url_for('static', filename='gyan-guru.png') }}" alt="Gyan Guru Logo" class="logo">-->
<!--  <h1>🧠 Gyan Guru Website Monitor</h1>-->
<!--</div>-->

<!--&lt;!&ndash; ✅ TOP BAR: Add Site + Category + Dark Mode + Reset All &ndash;&gt;-->
<!--<div class="top-bar">-->
<!--  <form action="/add" method="POST" class="form-inline">-->
<!--    <input name="name" placeholder="Website Name" required>-->
<!--    <input name="url" placeholder="URL" required>-->
<!--    <input name="selector" placeholder="CSS Selector" required>-->
<!--    <input name="category" placeholder="Category" required>-->
<!--    <button type="submit">➕ Add Site</button>-->
<!--  </form>-->

<!--  <div class="top-controls">-->
<!--    <label>Category:</label>-->
<!--    <select onchange="filterCategory(this)">-->
<!--      <option value="all">All</option>-->
<!--      {% for cat in categories %}-->
<!--      <option value="{{ cat }}">{{ cat }}</option>-->
<!--      {% endfor %}-->
<!--    </select>-->

<!--    <button onclick="toggleDarkMode()">🌓 Dark Mode</button>-->
<!--    <button class="reset-button" onclick="resetAll()">🔁 Reset All</button>-->
<!--  </div>-->
<!--</div>-->

<!--&lt;!&ndash; ✅ MONITORING TABLE &ndash;&gt;-->
<!--<table>-->
<!--  <thead>-->
<!--    <tr>-->
<!--      <th>Website</th>-->
<!--      <th>Category</th>-->
<!--      <th>URL</th>-->
<!--      <th>Updates</th>-->
<!--      <th>Status</th>-->
<!--      <th>Last Checked</th>-->
<!--      <th>Actions</th>-->
<!--    </tr>-->
<!--  </thead>-->
<!--  <tbody>-->
<!--    {% include 'table_body.html' %}-->
<!--  </tbody>-->
<!--</table>-->

<!--&lt;!&ndash; ✅ UPDATE HISTORY MODAL &ndash;&gt;-->
<!--<div id="historyModal" class="modal">-->
<!--  <div class="modal-content">-->
<!--    <span class="close" onclick="closeModal()">×</span>-->
<!--    <h2>🔍 Update History</h2>-->
<!--    <div id="historyContent"></div>-->
<!--  </div>-->
<!--</div>-->

<!--</body>-->
<!--</html>-->


<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>Gyan Guru Website Monitor</title>-->
<!--    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">-->
<!--    <script>-->
<!--    function toggleDarkMode() {-->
<!--      const isDark = document.body.classList.toggle('dark-mode');-->
<!--      localStorage.setItem('darkMode', isDark ? 'enabled' : 'disabled');-->
<!--    }-->

<!--    window.onload = function() {-->
<!--      if (localStorage.getItem('darkMode') === 'enabled') {-->
<!--        document.body.classList.add('dark-mode');-->
<!--      }-->
<!--    };-->

<!--    function filterCategory(select) {-->
<!--      const selected = select.value.toLowerCase();-->
<!--      document.querySelectorAll("tbody tr").forEach(row => {-->
<!--        const cat = row.getAttribute("data-category");-->
<!--        row.style.display = (selected === "all" || cat === selected) ? "" : "none";-->
<!--      });-->
<!--    }-->

<!--    function showHistory(index) {-->
<!--      fetch(`/updates/${index}`)-->
<!--        .then(res => res.json())-->
<!--        .then(history => {-->
<!--          const modal = document.getElementById("historyModal");-->
<!--          const container = document.getElementById("historyContent");-->
<!--          container.innerHTML = "";-->
<!--          if (history.length === 0) {-->
<!--            container.innerHTML = "<p>No update history available.</p>";-->
<!--          } else {-->
<!--            history.forEach((item, i) => {-->
<!--              const div = document.createElement("div");-->
<!--              div.className = "history-entry";-->
<!--              div.innerHTML = `-->
<!--                <strong>Version ${i + 1}</strong> - <em>${item.timestamp}</em>-->
<!--                <pre>${item.content}</pre>-->
<!--                <hr>-->
<!--              `;-->
<!--              container.appendChild(div);-->
<!--            });-->
<!--          }-->
<!--          modal.style.display = "block";-->
<!--        });-->
<!--    }-->

<!--    function closeModal() {-->
<!--      document.getElementById("historyModal").style.display = "none";-->
<!--    }-->

<!--    function resetAll() {-->
<!--      if (confirm("Are you sure you want to reset all site tracking data?")) {-->
<!--        fetch("/reset_all", { method: "POST" })-->
<!--          .then(res => res.json())-->
<!--          .then(data => {-->
<!--            if (data.status === "reset") {-->
<!--              alert("All sites have been reset.");-->
<!--              location.reload();-->
<!--            } else {-->
<!--              alert("Reset failed.");-->
<!--            }-->
<!--          });-->
<!--      }-->
<!--    }-->

<!--    window.onclick = function(event) {-->
<!--      const modal = document.getElementById("historyModal");-->
<!--      if (event.target === modal) modal.style.display = "none";-->
<!--    };-->

<!--    setInterval(() => {-->
<!--      fetch("/table-data")-->
<!--        .then(res => res.text())-->
<!--        .then(html => {-->
<!--          document.querySelector("tbody").innerHTML = html;-->
<!--        });-->
<!--    }, 60000);-->

<!--    </script>-->
<!--</head>-->
<!--<body>-->

<!--<div class="header-container">-->
<!--    <img src="{{ url_for('static', filename='gyan-guru.png') }}" alt="Gyan Guru Logo" class="logo">-->
<!--    <h1>🧠 Gyan Guru Website Monitor</h1>-->
<!--</div>-->

<!--<div class="top-bar">-->
<!--    <form action="/add" method="POST" class="form-inline">-->
<!--        <input name="name" placeholder="Website Name" required>-->
<!--        <input name="url" placeholder="URL" required>-->
<!--        <input name="selector" placeholder="CSS Selector" required>-->
<!--        <input name="category" placeholder="Category" required>-->
<!--        <button type="submit">➕ Add Site</button>-->
<!--    </form>-->

<!--    <div class="top-controls">-->
<!--        <label>Category:</label>-->
<!--        <select onchange="filterCategory(this)">-->
<!--            <option value="all">All</option>-->
<!--            {% for cat in categories %}-->
<!--            <option value="{{ cat }}">{{ cat }}</option>-->
<!--            {% endfor %}-->
<!--        </select>-->

<!--        <button onclick="toggleDarkMode()">🌓 Dark Mode</button>-->
<!--        <button class="reset-button" onclick="resetAll()">🔁 Reset All</button>-->
<!--    </div>-->
<!--</div>-->

<!--<table>-->
<!--    <thead>-->
<!--    <tr>-->
<!--        <th>Website</th>-->
<!--        <th>Category</th>-->
<!--        <th>URL</th>-->
<!--        <th>Updates</th>-->
<!--        <th>Status</th>-->
<!--        <th>Last Checked</th>-->
<!--        <th>Actions</th>-->
<!--    </tr>-->
<!--    </thead>-->
<!--    <tbody>-->
<!--    {% include 'table_body.html' %}-->
<!--    </tbody>-->
<!--</table>-->

<!--<div id="historyModal" class="modal">-->
<!--    <div class="modal-content">-->
<!--        <span class="close" onclick="closeModal()">×</span>-->
<!--        <h2>🔍 Update History</h2>-->
<!--        <div id="historyContent"></div>-->
<!--    </div>-->
<!--</div>-->

<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Gyan Guru Website Monitor</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script>
    // ✅ Toggle + persist dark mode
    function toggleDarkMode() {
      const isDark = document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', isDark ? 'enabled' : 'disabled');
    }

    // ✅ Load dark mode from localStorage
    window.onload = function() {
      if (localStorage.getItem('darkMode') === 'enabled') {
        document.body.classList.add('dark-mode');
      }
    };

    function filterCategory(select) {
      const selected = select.value.toLowerCase();
      document.querySelectorAll("tbody tr").forEach(row => {
        const cat = row.getAttribute("data-category");
        row.style.display = (selected === "all" || cat === selected) ? "" : "none";
      });
    }

    function showHistory(index) {
      fetch(`/updates/${index}`)
        .then(res => res.json())
        .then(history => {
          const modal = document.getElementById("historyModal");
          const container = document.getElementById("historyContent");
          container.innerHTML = "";
          if (history.length === 0) {
            container.innerHTML = "<p>No update history available.</p>";
          } else {
            history.forEach((item, i) => {
              const div = document.createElement("div");
              div.className = "history-entry";
              div.innerHTML = `
                <strong>Version ${i + 1}</strong> - <em>${item.timestamp}</em>
                <pre>${item.content}</pre>
                <hr>
              `;
              container.appendChild(div);
            });
          }
          modal.style.display = "block";
        });
    }

    function closeModal() {
      document.getElementById("historyModal").style.display = "none";
    }

    function resetAll() {
      if (confirm("Are you sure you want to reset all site tracking data?")) {
        fetch("/reset_all", { method: "POST" })
          .then(res => res.json())
          .then(data => {
            if (data.status === "reset") {
              alert("All sites have been reset.");
              location.reload();
            } else {
              alert("Reset failed.");
            }
          });
      }
    }

    window.onclick = function(event) {
      const modal = document.getElementById("historyModal");
      if (event.target === modal) modal.style.display = "none";
    };

    // ✅ Auto-refresh table body every 60s
    setInterval(() => {
      fetch("/table-data")
        .then(res => res.text())
        .then(html => {
          document.querySelector("tbody").innerHTML = html;
        });
    }, 60000);
  </script>
</head>
<body>

<!-- ✅ HEADER WITH LOGO LEFT AND CENTERED TITLE -->
<div class="header-container">
  <img src="{{ url_for('static', filename='gyan-guru.png') }}" alt="Gyan Guru Logo" class="logo">
  <h1>🧠 Gyan Guru Website Monitor</h1>
</div>

<!-- ✅ TOP BAR: Add Site + Category + Dark Mode + Reset All -->
<div class="top-bar">
  <form action="/add" method="POST" class="form-inline">
    <input name="name" placeholder="Website Name" required>
    <input name="url" placeholder="URL" required>
    <input name="selector" placeholder="CSS Selector" required>
    <input name="category" placeholder="Category" required>
    <button type="submit">➕ Add Site</button>
  </form>

  <div class="top-controls">
    <label>Category:</label>
    <select onchange="filterCategory(this)">
      <option value="all">All</option>
      {% for cat in categories %}
      <option value="{{ cat }}">{{ cat }}</option>
      {% endfor %}
    </select>

    <button onclick="toggleDarkMode()">🌓 Dark Mode</button>
    <button class="reset-button" onclick="resetAll()">🔁 Reset All</button>
  </div>
</div>

<!-- ✅ MONITORING TABLE -->
<table>
  <thead>
    <tr>
      <th>Website</th>
      <th>Category</th>
      <th>URL</th>
      <th>Updates</th>
      <th>Status</th>
      <th>Last Checked</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% include 'table_body.html' %}
  </tbody>
</table>

<!-- ✅ UPDATE HISTORY MODAL -->
<div id="historyModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">×</span>
    <h2>🔍 Update History</h2>
    <div id="historyContent"></div>
  </div>
</div>

</body>
</html>
